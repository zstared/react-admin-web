(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"8aoI":function(e,a,t){"use strict";var l=t("oWcC"),i=t("eVuz");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("+L6B");var r=l(t("2/Rp"));t("7Kak");var s=l(t("9yH6"));t("5NDa");var n=l(t("5rEg")),d=l(t("CAYl")),u=l(t("18bz"));t("miYZ");var m=l(t("tsqr")),o=l(t("UpVr"));t("y8nQ");var f,p,c,v,h=l(t("Vl3Y")),g=i(t("q1tI")),b=t("WXbf"),E=t("LLXN"),x=l(t("uBsN")),w=t("Yfch"),L=h.default.Item,M=(f=(0,b.connect)(e=>{var a=e.app;return{currentUser:a.currentUser}}),p=h.default.create(),f(c=p((v=class extends g.PureComponent{constructor(){var e;e=super(...arguments),this.handleSubmit=(a=>{a.preventDefault(),this.props.form.validateFields(function(){var a=(0,o.default)(u.default.mark(function a(t,l){var i,r,s,n;return u.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(t){a.next=8;break}return i=l.avatar_file[0],r=i?i.code:"",l.avatar_file=i,s=Object.assign(e.props.currentUser,l,{avatar:r}),n=e.props.dispatch,a.next=8,n({type:"app/updateCurrentUser",payload:s,callback:()=>{m.default.success((0,E.formatMessage)({id:"msg.saved"}))}});case 8:case"end":return a.stop()}},a,this)}));return function(e,t){return a.apply(this,arguments)}}())})}render(){var e=this.props.form.getFieldDecorator,a=this.props.currentUser,t={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}};return g.default.createElement("div",{style:{width:"600px"}},g.default.createElement("h2",null,g.default.createElement(E.FormattedMessage,{id:"menu.setting.base"})),g.default.createElement(h.default,{onSubmit:this.handleSubmit},g.default.createElement(L,(0,d.default)({},t,{label:(0,E.formatMessage)({id:"label.avatar"})}),e("avatar_file",{valuePropName:"fileList",initialValue:a.avatar_file?[a.avatar_file]:[]})(g.default.createElement(x.default,{maxLimit:1,data:{is_static:!0,folder_name:"avatar",is_thumb:!0}}))),g.default.createElement(L,(0,d.default)({},t,{label:(0,E.formatMessage)({id:"label.name-cn"})}),e("name_cn",{initialValue:a.name_cn,rules:[{required:!0,whitespace:!1,message:(0,E.formatMessage)({id:"validation.name-cn.required"})},{max:50,min:1,pattern:w.regNameCn,message:(0,E.formatMessage)({id:"validation.name-cn"})}]})(g.default.createElement(n.default,null))),g.default.createElement(L,(0,d.default)({},t,{label:(0,E.formatMessage)({id:"label.name-en"})}),e("name_en",{initialValue:a.name_en,rules:[{whitespace:!0,message:(0,E.formatMessage)({id:"validation.name-en.required"})},{max:50,min:1,pattern:w.regNameEn,message:(0,E.formatMessage)({id:"validation.name-en"})}]})(g.default.createElement(n.default,null))),g.default.createElement(L,(0,d.default)({},t,{label:(0,E.formatMessage)({id:"label.sex"})}),e("sex",{initialValue:a.sex,rules:[{required:!0}]})(g.default.createElement(s.default.Group,null,g.default.createElement(s.default,{value:1},g.default.createElement(E.FormattedMessage,{id:"label.sex.male"})),g.default.createElement(s.default,{value:2},g.default.createElement(E.FormattedMessage,{id:"label.sex.female"}))))),g.default.createElement(L,(0,d.default)({},t,{label:(0,E.formatMessage)({id:"label.mobile"})}),e("mobile",{initialValue:a.mobile,rules:[{required:!0,message:(0,E.formatMessage)({id:"validation.mobile.required"})},{pattern:w.regPhone,message:(0,E.formatMessage)({id:"validation.mobile"})}]})(g.default.createElement(n.default,null))),g.default.createElement(L,(0,d.default)({},t,{label:(0,E.formatMessage)({id:"label.email"})}),e("mail",{initialValue:a.mail,rules:[{type:"email",message:(0,E.formatMessage)({id:"validation.email"})}]})(g.default.createElement(n.default,null))),g.default.createElement(h.default.Item,{wrapperCol:{span:12,offset:6},style:{textAlign:"center"}},g.default.createElement(r.default,{type:"primary",htmlType:"submit"},g.default.createElement(E.FormattedMessage,{id:"button.save"})))))}},c=v))||c)||c),_=M;a.default=_},uBsN:function(e,a,t){"use strict";var l=t("eVuz"),i=t("oWcC");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("DZo9");var r=i(t("8z0m"));t("Pwec");var s=i(t("CtXQ"));t("miYZ");var n=i(t("tsqr")),d=l(t("q1tI")),u=(i(t("17x9")),i(t("ExhV"))),m=i(t("DlBl"));t("yP6L");var o=t("LLXN"),f=["image/jpeg","image/jpg","image/png","image/gif"];class p extends d.PureComponent{constructor(e){super(e),this.beforeUpload=((e,a)=>{var t=this.props.maxLimit,l=!0;if(t>0){var i=this.state.fileList.length+a.length;i>t&&(n.default.error((0,o.formatMessage)({id:"upload.validation.limit-number"})),l=!1)}var r=f.some(a=>a==e.type);r||n.default.error((0,o.formatMessage)({id:"upload.validation.limit-image-type"}));var s=e.size/1024/1024<5;return s||n.default.error((0,o.formatMessage)({id:"upload.validation.limit-size"})),r&&s&&l}),this.handleChange=(e=>{var a=e.file,t=e.fileList,l=this.props.onChange;if("done"==a.status){var i=a.response;i.code&&n.default.error(i.message)}t=t.map(e=>{if(e.response){if(0==e.response.code){var a=e.response.data,t=a.code,l=a.url,i=a.thumb_url;return{uid:e.uid,code:t,name:e.name,size:e.size,type:e.type,url:l,src:l,status:"done",thumbUrl:i}}e.status="error"}return e}),t=t.filter(e=>{return"done"==e.status||"uploading"==e.status}),this.setState({fileList:t}),"done"==a.status&&l(t)}),this.handlePreview=(e=>{var a=0;1!=this.props.maxLimit&&this.state.fileList.forEach((t,l)=>{t.uid==e.uid&&(a=l)}),this.setState({viewVisible:!0,viewIndex:a})}),this.handleRemove=(e=>{var a=this.props.onChange,t=this.state.fileList.filter(a=>{return a.uid!==e.uid});a(t)});var a=e.fileList||[];this.state={fileList:a,viewVisible:!1,viewIndex:0}}render(){var e=this.props,a=e.data,t=e.uploadText,l=e.maxLimit,i=e.multiple,n=d.default.createElement("div",null,d.default.createElement(s.default,{type:"plus"}),d.default.createElement("div",{className:"ant-upload-text"},t));return d.default.createElement("div",null,d.default.createElement(r.default,{name:"file",multiple:i,data:a,listType:"picture-card",showUploadList:!0,action:u.default.api_url+"/core/file/upload",beforeUpload:this.beforeUpload,onChange:this.handleChange,headers:{token:localStorage.getItem("token")},fileList:this.state.fileList,onRemove:this.handleRemove,onPreview:this.handlePreview},this.state.fileList.length>=l&&0!=l?null:n),d.default.createElement(m.default,{images:this.state.fileList,onClose:()=>{this.setState({viewVisible:!1})},activeIndex:this.state.viewIndex,visible:this.state.viewVisible}))}}p.defaultProps={uploadText:(0,o.formatMessage)({id:"label.upload"}),data:{folder_name:"",is_static:!0,is_thumb:!0},multiple:!1,maxLimit:0};var c=p;a.default=c}}]);